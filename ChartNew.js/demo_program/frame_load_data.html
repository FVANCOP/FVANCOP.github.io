<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=windows-1250">
  <meta name="generator" content="PSPad editor, www.pspad.com">
  <title></title>
  </head>
  <SCRIPT src='chart_list.js'></script>
  <SCRIPT>

  if(!Array.prototype.indexOf) {
    Array.prototype.indexOf = function(needle) {
        for(var i = 0; i < this.length; i++) {
            if(this[i] === needle) {
                return i;
            }
        }
        return -1;
    };
  }
  
  function toTitleCase(str)
  {
    return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
  }
  function Comparator(a,b){
    if (a[6] == "Demo$$$Demo") return -1;
    if (b[6] == "Demo$$$Demo") return 1;
    
    if (a[6] < b[6]) return -1;
    if (a[6] > b[6]) return 1;
    return 0;
  };

  for(i=0;i<lst.length;i++) {
  	lst[i].push((toTitleCase(lst[i][2].substring(3,200).split(' ')[0].toUpperCase())))
  	lst[i].push(toTitleCase(lst[i][2].split(' ')[0].toUpperCase())+"$$$"+toTitleCase(lst[i][0]));
  };
  
  function reloadChart() {
//  	parent.chart_frame.location.reload();
  	top.chart_frame.location.reload();
  };
  
  // Sort array;
  
  // compute categories;
  
  var categories=[];
//  categories.push(lst[0][5]);

  lst=lst.sort(Comparator);


  var cat="";

  var i;
  for(i=0;i<lst.length;i++)
  {
	if (categories.indexOf(lst[i][5]) <=-1) categories.push(lst[i][5]);
  };
  
  // create Menu;
  
  var menu=[];  
  for(i=0;i<categories.length;i++) {
	for(j=0;j<lst.length;j++) {
		if(lst[j][5]===categories[i]){
			menu.push([lst[j][5],toTitleCase(lst[j][0]),j,0]);
		}
	}	
  };
  
  // Load info;
  var curElt=0;
  var setInit="";
  if((top.location.href+"").indexOf("#") >0)setInit=top.location.href.substring((top.location.href+"").indexOf("#")+1);

  for(i=0;i<lst.length;i++) {
  	if (setInit==lst[i][1]){curElt=i;}
  }
  
    
  function loadInfo(elt) {
  	curElt=elt;
	// Load Chart;
  	top.chart_frame.location.href=lst[elt][1];
  	// Load Description;
  	top.desc_frame.location.reload();
  };
  loadInfo(curElt);
  
  // Load Menu;
  top.menu_frame.location.href="frame_menu.html";

  
  </SCRIPT>
  <body>
  Load Data...
  <SCRIPT>
  document.write("Nb Elt: "+lst.length+" "+categories[0]+" "+categories.length+"<BR>");

  for(i=0;i<menu.length;i++) {
  	document.write("["+menu[i][0]+","+menu[i][1]+"]<BR>");
  }	
  </SCRIPT>
  </body>
</html>
